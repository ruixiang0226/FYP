name: Upload Photos and HTML

on:
  push:
    branches:
      - main # Change this to your default branch if not 'main'

jobs:
  upload:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Code
        uses: actions/checkout@v2
        
      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '7.4'  # 修改为你需要的版本

      - name: Run Custom PHP Script
        run: php api/process_admin.php

      - name: Upload Vendor Photos
        if: github.event.inputs.image_type == 'vendor_img'
        uses: actions/upload-artifact@v2
        with:
          name: vendor-photos
          path: vendorpage/img_vendor/vendorpage_${{ github.event.inputs.vendor_name }}/vendor_img/*.*

      - name: Upload Menu Photos
        if: github.event.inputs.image_type == 'menu_img'
        uses: actions/upload-artifact@v2
        with:
          name: menu-photos
          path: vendorpage/img_vendor/vendorpage_${{ github.event.inputs.vendor_name }}/menu_img/*.*

      - name: Upload HTML Files
        uses: actions/upload-artifact@v2
        with:
          name: html
          path: vendorpage/${{ github.event.inputs.vendor_name }}.html
